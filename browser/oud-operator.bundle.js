!function(t){var e={};function i(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(s,r,function(e){return t[e]}.bind(null,r));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var i in t)e.hasOwnProperty(i)||(e[i]=t[i])}(i(1))},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{constructor(t){this._r=0,this._g=0,this._b=0,void 0!==t&&this.setFromHEX(t)}setFromHEX(t){let e=[t.match(/^#([0-9a-fA-F])([0-9a-fA-F])([0-9a-fA-F])$/),t.match(/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/)];null!==e[0]?(this._r=parseInt(e[0][1]+e[0][1],16),this._g=parseInt(e[0][2]+e[0][2],16),this._b=parseInt(e[0][3]+e[0][3],16)):null!==e[1]?(this._r=parseInt(e[1][1],16),this._g=parseInt(e[1][2],16),this._b=parseInt(e[1][3],16)):console.log("ERROR")}setFromABGR(t){let e=t.match(/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/);this._r=parseInt(e[4],16),this._g=parseInt(e[3],16),this._b=parseInt(e[2],16)}RGB(){return"rgb("+this._r+", "+this._g+", "+this._b+")"}HEX(t=!0){return(t?"#":"")+this._r.toString(16)+this._g.toString(16)+this._b.toString(16)}BGR(t=!0){return(t?"#":"")+this._b.toString(16)+this._g.toString(16)+this._r.toString(16)+"00"}}e.Color=s;class r{constructor(t){if(this.isNull=!0,this._h=0,this._m=0,this._s=0,null==t)return this.isNull=!0,this._h=0,this._m=0,void(this._s=0);this.setTime(t)}setTime(t){if(null===t.match(/^[0-9]{3,6}$/))return this._h=0,this._m=0,void(this._s=0);let e=parseInt(t);3<=t.length&&t.length<=4?(this._h=Math.floor(e/100),this._m=e%100,this._s=0):5<=t.length&&t.length<=6&&(this._h=Math.floor(e/1e4),this._m=Math.floor(e%1e4/100),this._s=e%100),this.normalize()}__slice(t){return("00"+t).slice(-2)}get h(){if(!this.isNull)return this.__slice(this._h)}set h(t){void 0!==typeof t&&(this._h=0);let e=parseInt(t);this._h=NaN===e?0:e}get m(){if(!this.isNull)return this.__slice(this._h)}set m(t){let e=parseInt(t);this._m=NaN===e?0:e}get s(){if(!this.isNull)return this.__slice(this._h)}set s(t){let e=parseInt(t);this._s=NaN===e?0:e}normalize(){this._m+=Math.floor(this._s/60),this._h+=Math.floor(this._m/60),this._s%=60,this._m%=60,this._h%=24}str(t=!0,e=!0){return t?this.h+":"+this.m+(e?":"+this.s:""):this.h+this.m+(e?this.s:"")}}e.Time=r;class n{constructor(){this._fileType="",this._fileTypeAppComment="",this._name="",this._color=new s,this._stations=new Array,this._trainTypes=new Array,this._diagrams=new Array,this.fileStruct={Rosen:[[]],Eki:[[]],Ressyasyubetsu:[[]],Dia:[{}],DispProp:[[]]}}get fileStruct(){return this._fileStruct}set fileStruct(t){this._fileStruct=t}get fileType(){return this._fileType}set fileType(t){this._fileType=t}get fileTypeAppComment(){return this._fileTypeAppComment}set fileTypeAppComment(t){this._fileTypeAppComment=t}get name(){return this._name}set name(t){this._name=t}get color(){return this._color}set color(t){this._color=t}get stations(){return this._stations}set stations(t){this._stations=t}get trainTypes(){return this._trainTypes}set trainTypes(t){this._trainTypes=t}get diagrams(){return this._diagrams}set diagrams(t){this._diagrams=t}static command(t){return t.split(/=/)[0]}static value(t){return t.split(/=/)[1]}static split(t){return[n.command(t),n.value(t)]}fromOud(t){return new Promise((e,i)=>{let s="";for(let e=0;e<t.length;e++){let i=t[e],r=i.match(/^(.+)\.$/),n=i.match(/^\.$/);if(null!==r)if("Dia"==(s=r[1])){let i="root",s={start:e,end:-1,Kudari:[[]],Nobori:[[]]},r="";for(let n=e+=1;n<t.length;n++){let a=t[n],o=a.match(/^(.+)\.$/),h=a.match(/^\.$/);if(null!==o)"Kudari"==(r=o[1])?i="Kudari":"Nobori"==r?i="Nobori":"Ressya"==r&&(s[i][s[i].length]={start:n});else if(null!==h)if("Ressya"==r)s[i][s[i].length-1].end=n,r=i;else if("Kudari"==i||"Nobori"==i)s[i][s[i].length-1].end=n,s[i].shift(),i="root";else if("root"==i){e=n;break}}s.end=e,this.fileStruct.Dia.push(s)}else this.fileStruct[s][this.fileStruct[s].length]={start:e};else null!==n&&("Dia"==s?this.fileStruct.Rosen[this.fileStruct.Rosen.length-1].end=e:this.fileStruct[s][this.fileStruct[s].length-1].end=e)}this.fileStruct.Rosen.shift(),this.fileStruct.Eki.shift(),this.fileStruct.Ressyasyubetsu.shift(),this.fileStruct.Dia.shift(),this.fileStruct.DispProp.shift(),this.stations=new Array(this.fileStruct.Eki.length),this.trainTypes=new Array(this.fileStruct.Ressyasyubetsu.length),this.diagrams=new Array(this.fileStruct.Dia.length),e()}).then(()=>{Promise.all([new Promise((e,i)=>{let s=n.split(t[0]);if("FileType"!=s[0])return void i(1);this.fileType=s[1];let r=n.split(t[this.fileStruct.DispProp[this.fileStruct.DispProp.length-1].end+1]);"FileTypeAppComment"==r[0]?(this.fileTypeAppComment=r[1],e()):i(2)}),new Promise((e,i)=>{let s=[];for(let e=0;e<this.fileStruct.Eki.length;e++)s.push(new Promise((i,s)=>{let r=e,o=new a;for(let e=this.fileStruct.Eki[r].start;e<this.fileStruct.Eki[r].end;e++){let i=n.split(t[e]);switch(i[0]){case"Ekimei":o.name=i[1];break;case"Ekijikokukeisiki":o.timeType=a.timeTypeToInt(i[1]);break;case"Ekikibo":o.scale=a.scaleToInt(i[1]);break;case"Kyoukaisen":o.boundary=!0;break;case"DiagramRessyajouhouHyoujiKudari":o.trainInfoDown=a.trainInfoToInt(i[1]);break;case"DiagramRessyajouhouHyoujiNobori":o.trainInfoUp=a.trainInfoToInt(i[1])}}this.stations[r]=o,i()}));Promise.all(s).then(e)}),new Promise((e,i)=>{let r=[];for(let e=0;e<this.fileStruct.Ressyasyubetsu.length;e++)r.push(new Promise((i,r)=>{let a=e,h=new o;for(let e=this.fileStruct.Ressyasyubetsu[a].start;e<this.fileStruct.Ressyasyubetsu[a].end;e++){let i=n.split(t[e]);switch(i[0]){case"Syubetsumei":h.name=i[1];break;case"Ryakusyou":h.shortname=i[1];break;case"JikokuhyouMojiColor":let t=new s;t.setFromABGR(i[1]),h.trainColor=t;break;case"JikokuhyouMojiIndex":h.fontIdx=Number.parseInt(i[1]);break;case"DiagramSenColor":let e=new s;e.setFromABGR(i[1]),h.lineColor=e;break;case"DiagramSenStyle":h.lineType=o.lineStyleToInt(i[1]);break;case"DiagramSenIsBold":h.lineWeight=2;break;case"StopMarkDrawType":h.shoudDrawStopMark=!0}}this.trainTypes[a]=h,i()}));Promise.all(r).then(e)}),new Promise((e,i)=>{let s=[];for(let e=0;e<this.fileStruct.Dia.length;e++)s.push(new Promise((i,s)=>{let a=e,o=new h;o.downStreaks=new Array(this.fileStruct.Dia[a].Kudari.length),o.upStreaks=new Array(this.fileStruct.Dia[a].Nobori.length);let _=[];for(let e=0;e<this.fileStruct.Dia[a].Kudari.length;e++)_.push(new Promise((i,s)=>{let r=e,h=new l;for(let e=this.fileStruct.Dia[a].Kudari[r].start;e<this.fileStruct.Dia[a].Kudari[r].end;e++){let i=n.split(t[e]);switch(i[0]){case"Syubetsu":h.typeIdx=Number.parseInt(i[1]);break;case"RessyaBangou":h.operationNum=i[1];break;case"Ressyamei":h.name=i[1];break;case"Gousuu":h.no=i[1];break;case"EkiJikoku":let t=i[1].split(","),e=new Array(t.length);for(let i=0;i<t.length;i++){let s=t[i],r=new u;if(""!==s){const t=s.split(";");if(r.type=Number.parseInt(t[0]),void 0!==t[1]){const e=t[1].split("/");void 0===e[1]?(r.arrival.isNull=!0,r.departure.isNull=!1,r.departure.setTime(e[0])):""===e[1]?(r.arrival.isNull=!1,r.arrival.setTime(e[0]),r.departure.isNull=!0):(r.departure.isNull=!1,r.departure.setTime(e[0]),r.arrival.isNull=!1,r.arrival.setTime(e[1]))}}e[i]=r}h.stHandlings=e;break;case"Bikou":h.comment=i[1]}}o.downStreaks[r]=h,i()}));for(let e=0;e<this.fileStruct.Dia[a].Nobori.length;e++)_.push(new Promise((i,s)=>{let h=e,_=new l;for(let e=this.fileStruct.Dia[a].Nobori[h].start;e<this.fileStruct.Dia[a].Nobori[h].end;e++){let i=n.split(t[e]);switch(i[0]){case"Syubetsu":_.typeIdx=Number.parseInt(i[1]);break;case"RessyaBangou":_.operationNum=i[1];break;case"Ressyamei":_.name=i[1];break;case"Gousuu":_.no=i[1];break;case"EkiJikoku":let t=i[1].split(","),e=new Array(t.length);for(let i=0;i<t.length;i++){let s=t[i],n=new u;if(""!==s){const t=s.split(";");n.type=Number.parseInt(t[0]);var p=new r,c=new r;if(void 0!==t[1]){const e=t[1].split("/");void 0===e[1]?(p.isNull=!0,c.setTime(e[0])):""===e[1]?(p.setTime(e[0]),c.isNull=!0):(c.setTime(e[0]),p.setTime(e[1]))}else p.isNull=!0,c.isNull=!0;n.arrival=p,n.departure=c}e[i]=n}_.stHandlings=e;break;case"Bikou":_.comment=i[1]}}o.upStreaks[h]=_,i()}));this.diagrams[a]=o,i()}));Promise.all(s).then(e)})]).then(()=>{}).catch(()=>console.log("ERROR"))})}}e.DataSet=n;class a{constructor(){this._name="",this._timeType=0,this._scale=0,this._trainInfoDown=0,this._trainInfoUp=0,this._boundary=!1,this._additionalOption=0,this._shouldShowLineNumberDown=!1,this._shouldShowLineNumberUp=!1,this._shouldShowLines=!1,this._lines=[],this._mainLineDown=0,this._mainLineUp=0}get name(){return this._name}set name(t){this._name=t}get timeType(){return this._timeType}set timeType(t){this._timeType=t}get scale(){return this._scale}set scale(t){this._scale=t}get trainInfoDown(){return this._trainInfoDown}set trainInfoDown(t){this._trainInfoDown=t}get trainInfoUp(){return this._trainInfoUp}set trainInfoUp(t){this._trainInfoUp=t}get boundary(){return this._boundary}set boundary(t){this._boundary=t}get additionalOption(){return this._additionalOption}set additionalOption(t){this._additionalOption=t}get shouldShowLineNumberDown(){return this._shouldShowLineNumberDown}set shouldShowLineNumberDown(t){this._shouldShowLineNumberDown=t}get shouldShowLineNumberUp(){return this._shouldShowLineNumberUp}set shouldShowLineNumberUp(t){this._shouldShowLineNumberUp=t}get shouldShowLines(){return this._shouldShowLines}set shouldShowLines(t){this._shouldShowLines=t}get lines(){return this._lines}set lines(t){this._lines=t}get mainLineDown(){return this._mainLineDown}set mainLineDown(t){this._mainLineDown=t}get mainLineUp(){return this._mainLineUp}set mainLineUp(t){this._mainLineUp=t}static timeTypeToInt(t){switch(t){case"Jikokukeisiki_Hatsuchaku":return 10;case"Jikokukeisiki_KudariChaku":return 20;case"Jikokukeisiki_NoboriChaku":return 30;default:return 0}}parseTimeType(){switch(this.timeType){case 10:return"Jikokukeisiki_Hatsuchaku";case 20:return"Jikokukeisiki_KudariChaku";case 30:return"Jikokukeisiki_NoboriChaku";default:return"Jikokukeisiki_Hatsu"}}static scaleToInt(t){switch(t){case"Ekikibo_Syuyou":return 10;default:return 0}}parseScale(){switch(this.scale){case 10:return"Ekikibo_Syuyou";default:return"Ekikibo_Ippan"}}static trainInfoToInt(t){switch(t){case"DiagramRessyajouhouHyouji_Anytime":return 20;case"DiagramRessyajouhouHyouji_Not":return 0;default:return 10}}}e.Station=a;class o{get name(){return this._name}set name(t){this._name=t}get shortname(){return this._shortname}set shortname(t){this._shortname=t}get trainColor(){return this._trainColor}set trainColor(t){this._trainColor=t}get fontIdx(){return this._fontIdx}set fontIdx(t){this._fontIdx=t}get lineColor(){return this._lineColor}set lineColor(t){this._lineColor=t}get lineType(){return this._lineType}set lineType(t){this._lineType=t}get lineWeight(){return this._lineWeight}set lineWeight(t){this._lineWeight=t}get shoudDrawStopMark(){return this._shoudDrawStopMark}set shoudDrawStopMark(t){this._shoudDrawStopMark=t}constructor(){this._name="",this._shortname="",this._trainColor=new s,this._fontIdx=0,this._lineColor=new s,this._lineType=0,this._lineWeight=0,this._shoudDrawStopMark=!1}static lineStyleToInt(t){switch(t){case"SenStyle_Tensen":return 10;case"SenStyle_Hasen":return 20;default:return 0}}}e.TrainType=o;class h{constructor(){this._name="",this._downStreaks=new Array,this._upStreaks=new Array}get name(){return this._name}set name(t){this._name=t}get downStreaks(){return this._downStreaks}set downStreaks(t){this._downStreaks=t}get upStreaks(){return this._upStreaks}set upStreaks(t){this._upStreaks=t}}e.Diagram=h;class l{constructor(){this._operationNum="",this._typeIdx=0,this._name="",this._destIdx=0,this._stHandlings=new Array,this._comment=""}get operationNum(){return this._operationNum}set operationNum(t){this._operationNum=t}get typeIdx(){return this._typeIdx}set typeIdx(t){this._typeIdx=t}get name(){return this._name}set name(t){this._name=t}get no(){return this._no}set no(t){this._no=t}get destIdx(){return this._destIdx}set destIdx(t){this._destIdx=t}get stHandlings(){return this._stHandlings}set stHandlings(t){this._stHandlings=t}get comment(){return this._comment}set comment(t){this._comment=t}}e.Streak=l;class u{constructor(){this._type=0,this._arrival=new r,this._departure=new r,this._track=0,this._endpointWork=EndpointWork,this.type=0,this.arrival=new r,this.departure=new r}get type(){return this._type}set type(t){this._type=t}get arrival(){return this._arrival}set arrival(t){this._arrival=t}get departure(){return this._departure}set departure(t){this._departure=t}get track(){return this._track}set track(t){this._track=t}get endpointWork(){return this._endpointWork}set endpointWork(t){this._endpointWork=t}}e.StHandling=u}]);